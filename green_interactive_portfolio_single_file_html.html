<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Your Name â€“ Portfolio</title>
  <meta name="description" content="Interactive portfolio with search, filters, modal details. Green theme." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    /* ============================
       THEME (Green palette)
       Tweak these to your taste
    ============================ */
    :root {
      --bg: #0b0f0c;           /* page background */
      --panel: #0f1511;        /* cards, inputs */
      --text: #e8f3ea;         /* main text */
      --muted: #9fb7a6;        /* secondary text */
      --brand: #20c05c;        /* primary green */
      --brand-2: #7ce2a8;      /* accent green */
      --chip: #122218;         /* tag bg */
      --border: #1b2a21;       /* subtle borders */
      --shadow: 0 10px 30px rgba(0,0,0,.28);
      --radius: 14px;
    }
    :root.light {
      --bg: #f6fbf8;
      --panel: #ffffff;
      --text: #0b0f0c;
      --muted: #4d5a52;
      --brand: #0e9f4a;
      --brand-2: #41d48a;
      --chip: #e9f7ef;
      --border: #dfe7e1;
      --shadow: 0 8px 22px rgba(16,24,40,.08);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 800px at 20% -5%, rgba(32,192,92,.15), transparent 55%),
                  radial-gradient(900px 600px at 120% 10%, rgba(65,212,138,.14), transparent 45%),
                  var(--bg);
      color: var(--text);
      line-height: 1.6;
    }
    .container { max-width: 1100px; margin: 0 auto; padding: 20px; }

    /* Header */
    .site-header { display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--border); gap: 14px; }
    .brand { display: flex; gap: 12px; align-items: center; }
    .avatar { width: 48px; height: 48px; display: grid; place-items: center; border-radius: 50%; background: linear-gradient(135deg, var(--brand), var(--brand-2)); color: #062010; font-weight: 800; box-shadow: var(--shadow); }
    .subtitle { color: var(--muted); margin-top: -6px; }
    .actions { display: flex; gap: 10px; align-items: center; }
    .btn { border: 1px solid var(--border); background: var(--panel); color: var(--text); padding: 8px 12px; border-radius: var(--radius); cursor: pointer; text-decoration: none; box-shadow: var(--shadow); transition: transform .08s ease; }
    .btn:hover { transform: translateY(-1px); }
    .btn.primary { background: linear-gradient(135deg, var(--brand), var(--brand-2)); color: #062010; border: none; font-weight: 700; }
    .btn.icon { padding: 6px 10px; }

    /* Hero */
    .hero { display: grid; grid-template-columns: 1.25fr .75fr; gap: 24px; align-items: center; margin-top: 22px; }
    .hero-img { width: 100%; border-radius: 18px; border: 1px solid var(--border); box-shadow: var(--shadow); background: linear-gradient(120deg, rgba(32,192,92,.15), rgba(65,212,138,.12)); aspect-ratio: 4/3; display: grid; place-items: center; color: var(--muted); font-weight: 600; }
    .quick-links { display: flex; gap: 8px; margin-top: 8px; flex-wrap: wrap; }
    .chip { display: inline-block; padding: 6px 10px; border-radius: 999px; background: var(--chip); color: var(--text); text-decoration: none; font-weight: 600; border: 1px solid var(--border); }

    /* Controls */
    .controls { display: grid; gap: 10px; grid-template-columns: 1fr; margin: 26px 0 8px; }
    #q { width: 100%; padding: 12px 14px; border-radius: var(--radius); border: 1px solid var(--border); background: var(--panel); color: var(--text); }
    .tag-bar { display: flex; gap: 8px; flex-wrap: wrap; }
    .tag { padding: 6px 10px; border-radius: 999px; border: 1px solid var(--border); background: var(--panel); cursor: pointer; }
    .tag.active { background: linear-gradient(135deg, var(--brand), var(--brand-2)); color: #062010; border-color: transparent; }
    .sort-row { display: flex; gap: 10px; align-items: center; }
    select { padding: 8px 10px; border-radius: 10px; border: 1px solid var(--border); background: var(--panel); color: var(--text); }

    /* Grid */
    .project-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
    .card { border: 1px solid var(--border); background: var(--panel); border-radius: 18px; overflow: hidden; display: flex; flex-direction: column; transition: transform .12s ease, box-shadow .12s ease; }
    .card:hover { transform: translateY(-2px); box-shadow: var(--shadow); }
    .card img { width: 100%; aspect-ratio: 16/9; object-fit: cover; background: linear-gradient(120deg, rgba(32,192,92,.15), rgba(65,212,138,.12)); }
    .card .content { padding: 12px; display: grid; gap: 6px; }
    .card .meta { display: flex; justify-content: space-between; color: var(--muted); font-size: .9rem; }
    .card .tags { display: flex; gap: 6px; flex-wrap: wrap; margin-top: 4px; }
    .card .tags .badge { font-size: .8rem; padding: 4px 8px; border: 1px solid var(--border); border-radius: 999px; }
    .card .actions { display: flex; gap: 8px; margin-top: 8px; }
    .card .actions a, .card .actions button { flex: 1; text-align: center; }

    /* Modal */
    dialog.modal { border: none; border-radius: 20px; padding: 0; max-width: 820px; width: 95%; background: var(--panel); color: var(--text); }
    dialog.modal::backdrop { background: rgba(0,0,0,.55); }
    .modal-inner { padding: 0; }
    .modal-header, .modal-footer { padding: 12px 16px; border-bottom: 1px solid var(--border); }
    .modal-footer { border-top: 1px solid var(--border); border-bottom: none; display: flex; gap: 8px; }
    .modal-body { padding: 16px; display: grid; gap: 10px; }

    /* Footer */
    .site-footer { border-top: 1px solid var(--border); margin-top: 40px; color: var(--muted); }
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); border: 0; }

    @media (max-width: 900px) {
      .hero { grid-template-columns: 1fr; }
      .project-grid { grid-template-columns: 1fr 1fr; }
    }
    @media (max-width: 600px) {
      .project-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <header class="site-header container">
    <div class="brand">
      <div class="avatar" aria-hidden="true">DD</div>
      <div>
        <h1 id="site-title">Dorra Dhibi</h1>
        <p class="subtitle">Industrial Biology Engineer â€¢ LCA & Sustainability</p>
      </div>
    </div>
    <nav class="actions">
      <button id="themeToggle" class="btn" aria-label="Toggle dark mode">ðŸŒ“</button>
      <a href="#contact" class="btn primary">Contact</a>
      <a href="https://www.linkedin.com/in/dorra-dhibi" target="_blank" rel="noopener" class="btn">RÃ©sumÃ©</a>
    </nav>
  </header>

  <main class="container">
    <!-- Hero -->
    <section class="hero" aria-labelledby="intro-title">
      <div>
        <h2 id="intro-title">I analyze & optimize products through LCA.</h2>
        <p><strong>Welcome to Dorra's Portfolio â€“ Where Environmental Engineering Meets Innovation.</strong><br/>Why hire me? Because I take initiative, lead by example, selfâ€‘learn fast, and leave a positive impact in every project. I'm an Industrial Biology Engineer turning complex environmental challenges into sustainable solutionsâ€”from LCAs achieving up to <strong>38% GHG reductions</strong> to awardâ€‘winning work in AI and climate policy.</p>
        <div class="quick-links">
          <a class="chip" href="#skills">Skills</a>
          <a class="chip" href="#projects">Projects</a>
          <a class="chip" href="#writing">Writing</a>
        </div>
      </div>
      <img class="hero-img" src="data:;base64,REPLACEME" alt="Portrait of Dorra Dhibi" />
    </section>

    <!-- Controls -->
    <section class="controls" aria-label="Filters and search">
      <input type="search" id="q" placeholder="Search projects (title, desc, tech)..." aria-label="Search projects" />
      <div id="tagBar" class="tag-bar" role="list" aria-label="Filter by tag"></div>
      <div class="sort-row">
        <label for="sort">Sort by:</label>
        <select id="sort" aria-label="Sort projects">
          <option value="newest">Newest</option>
          <option value="oldest">Oldest</option>
          <option value="az">A â†’ Z</option>
          <option value="za">Z â†’ A</option>
        </select>
      </div>
    </section>

    <!-- Projects Grid -->
    <section id="projects" class="grid" aria-labelledby="projects-title">
      <h2 id="projects-title" class="sr-only">Projects</h2>
      <div id="projectGrid" class="project-grid" aria-live="polite"></div>
    </section>

    <!-- Modal for project details -->
    <dialog id="projectModal" aria-labelledby="modalTitle" class="modal">
      <form method="dialog" class="modal-inner">
        <header class="modal-header">
          <h3 id="modalTitle">Project title</h3>
        </header>
        <div id="modalBody" class="modal-body"></div>
        <footer class="modal-footer">
          <button value="close" class="btn">Close</button>
        </footer>
      </form>
    </dialog>

    <!-- Contact -->
    <section id="contact" class="contact">
      <h2>Contact</h2>
      <form id="contactForm">
        <div class="row" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
          <input type="text" id="name" name="name" placeholder="Your name" required />
          <input type="email" id="email" name="email" placeholder="Your email" required />
        </div>
        <textarea id="message" name="message" placeholder="Your message..." required style="width:100%;padding:12px 14px;border:1px solid var(--border);border-radius:var(--radius);background:var(--panel);color:var(--text);min-height:120px;margin-top:10px;"></textarea>
        <button type="submit" class="btn primary">Send</button>
        <p class="help" style="color:var(--muted);">This demo form just prints to console. Hook it to a backend or Formspree.</p>
      </form>
    </section>
  </main>

  <footer class="site-footer container">
    <small>Â© <span id="year"></span> Your Name â€” Built with vanilla JS. Green & clean ðŸŒ¿</small>
  </footer>

  <script>
    // ======= Data: Edit your projects here =======
    const PROJECTS = [
  {
    id: "microalgae-biodiesel-lca",
    title: "Comparative LCA of Microalgae Biodiesel (PBR vs Raceway)",
    year: 2025,
    tags: ["LCA","Bioenergy","Research"],
    tech: ["openLCA","Ecoinvent","Python"],
    description: "Photobioreactors vs. open raceway pondsâ€”environmental tradeoffs for algae biodiesel.",
    long: "Compares cultivation/processing inventories for PBR vs ORP across three scenarios (lowâ€‘productivity coalâ€‘based, medium airâ€‘pumped, highâ€‘productivity optimized). Details allocation (systemâ€‘expansion vs physical), boundary choices, and hotspot analysisâ€”emphasizing energy intensity in PBRs vs land/water/contamination tradeâ€‘offs in ORPsâ€”and outlines conditions where each pathway minimizes impacts.",
    highlights: ["Scenario comparison (PBR vs ORP)","Hotspot analysis","Recommendations for energy inputs"],
    demo: "https://drive.google.com/file/d/1aBh45azVgrKT8o_I-0oFTAjDKnx1IOjH/view?usp=drive_link",
    repo: "",
    image: "__IMG_MICROALGAE__"
  },
  {
    id: "pyrolysis-lca",
    title: "LCA of Biomass & Plastic Waste Pyrolysis",
    year: 2025,
    tags: ["LCA","Circular Economy","Energy"],
    tech: ["openLCA","Python"],
    description: "Environmental assessment of pyrolysis for mixed biomass/plastics streams.",
    long: "Three scenariosâ€”slow pyrolysis (biomass), fast pyrolysis, and coâ€‘pyrolysis (biomass+plastics). Developed detailed inventories (sorting, pretreatment, reactor ops, condensation, upgrading; plus biochar/syngas valorization). Presents LCIA contributions and scenario comparison (GWP, CED, resources, acidification/eutrophication, water), uncertainty analyses, and improvement levers (energy integration, product upgrading, credits for avoided products via system expansion).",
    highlights: ["Feedstock sensitivity","Coâ€‘product system expansion","Energy recovery mapping"],
    demo: "https://drive.google.com/file/d/1yG_I_2fzkLJwaKeiEFlAFRJgBlmYYZ4Z/view?usp=drive_link",
    repo: "",
    image: "__IMG_PYROLYSIS__"
  },
  {
    id: "levulinic-acid-uncertainty",
    title: "LCA under Uncertainty: Levulinic Acid (Bio vs Petro)",
    year: 2025,
    tags: ["LCA","Uncertainty","Chemistry"],
    tech: ["openLCA","Monte Carlo","TEA"],
    description: "Bioâ€‘based vs petrochemical LA with sustainability, safety & TEA framing.",
    long: "Comparative LCA/TEA/safety framework for LA from lignocellulosic biomass (Biofineâ€‘type routes) versus the nâ€‘butane petroâ€‘route, with Aspen modeling and multiâ€‘objective optimization (cost, impacts, hazards). Treats coâ€‘products, applies Monteâ€‘Carlo + genetic algorithms to map Pareto tradeâ€‘offs and robustness under data uncertainty, and delivers a roadmap for uncertainty reduction and scaleâ€‘up decisions.",
    highlights: ["Monte Carlo propagation","Safety considerations","TEA integration"],
    demo: "https://drive.google.com/file/d/18IM9c6p5Of-J07kZaibXmKMmamFAKyjW/view?usp=drive_link",
    repo: "",
    image: "__IMG_LEVULINIC__"
  },
  {
    id: "phenolics-docking-env",
    title: "Molecular Docking & Environmental Applications of Phenolics",
    year: 2024,
    tags: ["Computational","Chemistry","Env. Eng."],
    tech: ["Docking","Python","R"],
    description: "Catechol, Kojic acid, Lâ€‘DOPA, Gallic acidâ€”binding insights with applied angles.",
    long: "Dual study: (i) bibliographic review of four phenolics for green remediation (metal chelation, redox mediation, antimicrobial/coating uses), and (ii) ArgusLab docking to catechol oxidase (PDB 1BUG) to examine binding and potential biocatalytic relevance. Summarizes physicochemical properties, interaction mechanisms, and implications for sustainable water treatment and pollution control.",
    highlights: ["Ligand panel","Scoring & validation","Applied interpretation"],
    demo: "https://drive.google.com/file/d/1DPAFFW-NcHDLbh5LpRudA8CQZAnmwqg9/view?usp=drive_link",
    repo: "",
    image: "__IMG_DOCKING__"
  },
  {
    id: "carbon-neutral-jetfuel-lca",
    title: "Life Cycle Assessment of Carbonâ€‘Neutral Jet Fuel",
    year: 2024,
    tags: ["LCA","Aviation","Energy"],
    tech: ["openLCA","Ecoinvent"],
    description: "Boundaryâ€‘consistent LCA for synthetic/alternative jet fuel pathways.",
    long: "Comprehensive LCA of a biorefinery pathway converting canolaâ€‘meal residues to sustainable aviation fuel via HTL followed by HDO. Defined goal/scope, unit processes (feedstock logistics, HTL, aqueous/solids handling, upgrading, blending, distribution, combustion), allocation/systemâ€‘expansion choices, and sensitivity on fertilizer and process energy. Highlights commercial integration prospects in Canada and quantifies environmental/economic hotspots across the chain.",
    highlights: ["Upstream CO2 sourcing","Energy demand hotspots","Offset boundaries"],
    demo: "https://drive.google.com/file/d/1fwRXczMo6qHlTwgFv0vo-2ARoAbnvLK1/view?usp=drive_link",
    repo: "",
    image: "__IMG_AVIATION__"
  },
  {
    id: "pla-phb-lca",
    title: "Comparative LCA of PLA vs PHB Bioplastics",
    year: 2025,
    tags: ["LCA","Bioplastics","Circular Economy"],
    tech: ["openLCA"],
    description: "PLA vs PHB across key stages with system expansion where relevant.",
    long: "Analyzes how input uncertainties (electricity, transport, water, enzymes) drive PLA/PHB results using OAT and global Monteâ€‘Carlo sensitivity. Tornado diagrams identify top contributors to GWP/CED/EP. Compares endâ€‘ofâ€‘life options (landfill vs composting) and applies MCDA (weightedâ€‘sum on endpoints) showing composting as generally preferable across normalized scores, with limitations noted.",
    highlights: ["EOL scenarios","Fossil benchmarks","Sensitivity analysis"],
    demo: "",
    repo: "",
    image: "__IMG_PLA_PHB__"
  },
  {
    id: "tmb-pipeline-melanoma",
    title: "Tumor Mutational Burden (TMB) Pipeline for Melanoma",
    year: 2024,
    tags: ["Bioinformatics","Pipeline"],
    tech: ["BWA","Samtools","GATK4","R","Shiny"],
    description: "Endâ€‘toâ€‘end workflow from FASTQ â†’ VCF with a Shiny explorer.",
    long: "Automated QC, hg38 indexing, and reproducible scripting; supports exploratory visualization.",
    highlights: ["QC automation","Reproducible scripts","Interactive Shiny"],
    demo: "",
    repo: "https://github.com/Dorradhibi/Tumor-Mutation-Burden-TMB-Analysis-",
    image: ""
  },
  {
    id: "cosmetics-innovation-natural",
    title: "Cosmetic Innovations: Natural Ingredients & Functionality",
    year: 2024,
    tags: ["Research","Cosmetics","Sustainability"],
    tech: ["Review","Evidence Synthesis"],
    description: "Which new naturals deliver real functional gains?",
    long: "Professional project on sunâ€‘care innovation: skin/UV science, filter types (organic/mineral), formulation/galenics (emulsions, HLB, stability), consumer trends/regulatory context. Experimental section formulates mineralâ€‘filter sunscreens; evaluates sensory, pH, centrifuge stability, rheology, spreadability, and UV spectrophotometry; and discusses how texture/stability choices affect efficacy and user acceptance.",
    highlights: ["Evidence scoring","Function vs footprint","R&D directions"],
    demo: "https://drive.google.com/file/d/1Xf7fu1PqpQfhCMW_bW7EfIMmzTC6Tr1P/view?usp=drive_link",
    repo: "",
    image: "__IMG_COSMETICS__"
  }
];

    // ======= State & Elements =======
    const state = { projects: PROJECTS, activeTags: new Set(), q: "", sort: "newest" };
    const els = {
      grid: document.getElementById("projectGrid"),
      q: document.getElementById("q"),
      sort: document.getElementById("sort"),
      tagBar: document.getElementById("tagBar"),
      modal: document.getElementById("projectModal"),
      modalTitle: document.getElementById("modalTitle"),
      modalBody: document.getElementById("modalBody"),
      themeToggle: document.getElementById("themeToggle"),
    };

    // ======= Theme =======
    (function initTheme(){
      const saved = localStorage.getItem("theme");
      if (saved === "light") document.documentElement.classList.add("light");
      document.getElementById("year").textContent = new Date().getFullYear();
      els.themeToggle.addEventListener("click", ()=>{
        document.documentElement.classList.toggle("light");
        localStorage.setItem("theme", document.documentElement.classList.contains("light") ? "light" : "dark");
      });
    })();

    // ======= Build Tags =======
    (function buildTagBar(data){
      const all = new Set();
      data.forEach(p => p.tags.forEach(t => all.add(t)));
      const tags = Array.from(all).sort((a,b)=>a.localeCompare(b));
      els.tagBar.innerHTML = "";
      tags.forEach(tag => {
        const btn = document.createElement("button");
        btn.className = "tag";
        btn.textContent = tag;
        btn.role = "listitem";
        btn.addEventListener("click", ()=>{
          if (state.activeTags.has(tag)) state.activeTags.delete(tag); else state.activeTags.add(tag);
          btn.classList.toggle("active");
          updateHash();
          render();
        });
        els.tagBar.appendChild(btn);
      });
    })(PROJECTS);

    // ======= Inputs =======
    els.q.addEventListener("input", e => { state.q = e.target.value.toLowerCase().trim(); updateHash(); render(); });
    els.sort.addEventListener("change", e => { state.sort = e.target.value; updateHash(); render(); });

    // ======= Render =======
    function render(){
      const {projects, activeTags, q, sort} = state;
      let list = projects.filter(p => {
        const matchesTags = activeTags.size === 0 || Array.from(activeTags).every(t => p.tags.includes(t));
        const hay = (p.title + " " + p.description + " " + p.tech.join(" ")).toLowerCase();
        const matchesQ = !q || hay.includes(q);
        return matchesTags && matchesQ;
      });

      if (sort === "newest") list.sort((a,b)=> (b.year||0) - (a.year||0));
      if (sort === "oldest") list.sort((a,b)=> (a.year||0) - (b.year||0));
      if (sort === "az") list.sort((a,b)=> a.title.localeCompare(b.title));
      if (sort === "za") list.sort((a,b)=> b.title.localeCompare(a.title));

      els.grid.innerHTML = "";
      list.forEach(p => {
        const card = document.createElement("article");
        card.className = "card";
        const imgSrc = p.image || "data:image/svg+xml;utf8," + encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 675'><defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='1'><stop offset='0%' stop-color='%2320c05c'/><stop offset='100%' stop-color='%237ce2a8'/></linearGradient></defs><rect width='1200' height='675' fill='url(%23g)'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-family='Inter,Arial' font-size='44' fill='white'>Project Screenshot</text></svg>`);
        card.innerHTML = `
          <img src="${imgSrc}" alt="${p.title} image" />
          <div class="content">
            <div class="meta">
              <strong>${p.title}</strong>
              <span>${p.year || ''}</span>
            </div>
            <p>${p.description}</p>
            <div class="tags">${p.tags.map(t=>`<span class="badge">${t}</span>`).join("")}</div>
            <div class="actions">
              ${p.demo ? `<a class="btn" href="${p.demo}" target="_blank" rel="noopener">Demo</a>` : ''}
              ${p.repo ? `<a class="btn" href="${p.repo}" target="_blank" rel="noopener">Code</a>` : ''}
              <button class="btn primary" data-id="${p.id}">Details</button>
            </div>
          </div>
        `;
        card.querySelector("button[data-id]").addEventListener("click", ()=> openModal(p));
        els.grid.appendChild(card);
      });
    }

    function openModal(p){
      els.modalTitle.textContent = p.title;
      const imgSrc = p.image || "data:image/svg+xml;utf8," + encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 675'><defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='1'><stop offset='0%' stop-color='%2320c05c'/><stop offset='100%' stop-color='%237ce2a8'/></linearGradient></defs><rect width='1200' height='675' fill='url(%23g)'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-family='Inter,Arial' font-size='44' fill='white'>${p.title}</text></svg>`);
      els.modalBody.innerHTML = `
        <img src="${imgSrc}" alt="${p.title} image" style="width:100%; border-radius:12px; border:1px solid var(--border);" />
        <p>${p.long || p.description}</p>
        ${p.highlights?.length ? `<ul>${p.highlights.map(h=>`<li>${h}</li>`).join("")}</ul>` : ''}
        <p><strong>Tech:</strong> ${p.tech.join(", ")}</p>
        <div class="actions">
          ${p.demo ? `<a class="btn" href="${p.demo}" target="_blank" rel="noopener">Live Demo</a>` : ''}
          ${p.repo ? `<a class="btn" href="${p.repo}" target="_blank" rel="noopener">Repository</a>` : ''}
        </div>
      `;
      // Deep-linking to modal
      const params = new URLSearchParams(location.hash.replace(/^#/, ""));
      params.set("project", encodeURIComponent(p.id));
      location.hash = `#${params.toString()}`;
      els.modal.showModal();
      els.modal.addEventListener("close", ()=> {
        const params2 = new URLSearchParams(location.hash.replace(/^#/, ""));
        params2.delete("project");
        const next = params2.toString();
        location.hash = next ? `#${next}` : "";
      }, { once: true });
    }

    // ======= URL Hash (q, tags, sort, project) =======
    function applyURLHash(){
      const params = new URLSearchParams(location.hash.replace(/^#/, ""));
      const q = params.get("q") || "";
      const sort = params.get("sort") || "newest";
      const tags = params.get("tags");
      const project = params.get("project");

      state.q = q; state.sort = sort; document.getElementById("q").value = q; document.getElementById("sort").value = sort;
      if (tags){ state.activeTags = new Set(tags.split(",").filter(Boolean)); syncActiveTagButtons(); }
      if (project){ const p = state.projects.find(x => x.id === decodeURIComponent(project)); if (p) openModal(p); }
    }
    function updateHash(){
      const params = new URLSearchParams();
      if (state.q) params.set("q", state.q);
      if (state.activeTags.size) params.set("tags", Array.from(state.activeTags).join(","));
      if (state.sort !== "newest") params.set("sort", state.sort);
      const next = params.toString();
      history.replaceState(null, "", next ? `#${next}` : "#");
    }
    function syncActiveTagButtons(){
      Array.from(els.tagBar.querySelectorAll(".tag")).forEach(btn => {
        if (state.activeTags.has(btn.textContent)) btn.classList.add("active"); else btn.classList.remove("active");
      });
    }

    window.addEventListener("hashchange", applyURLHash);

    // Initial render
    render();
    applyURLHash();

    // Contact demo
    document.getElementById("contactForm").addEventListener("submit", (e)=>{
      e.preventDefault();
      const data = Object.fromEntries(new FormData(e.target).entries());
      console.log("Contact form submission (demo):", data);
      alert("Thanks! This demo form just logs to console. Replace with your backend or Formspree.");
    });
  </script>
</body>
</html>
